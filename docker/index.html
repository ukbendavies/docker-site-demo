



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Demonstration of a mkdocs site published as a docker image using a small nginx linux image as a base.">
      
      
      
        <meta name="author" content="https://github.com/ukbendavies">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.2">
    
    
      
        <title>Build - docker-site-demo</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.ba0fd1a6.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#install-docker-for-the-first-time" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="docker-site-demo" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                docker-site-demo
              </span>
              <span class="md-header-nav__topic">
                Build
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/ukbendavies/docker-site-demo/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ukbendavies/docker-site-demo
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    docker-site-demo
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/ukbendavies/docker-site-demo/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ukbendavies/docker-site-demo
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Abstract" class="md-nav__link">
      Abstract
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Build
      </label>
    
    <a href="./" title="Build" class="md-nav__link md-nav__link--active">
      Build
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-docker-for-the-first-time" title="Install Docker for the first time" class="md-nav__link">
    Install Docker for the first time
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-docker-community-edition" title="Get Docker community-edition" class="md-nav__link">
    Get Docker community-edition
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-mkdocs-environment" title="Install mkdocs environment" class="md-nav__link">
    Install mkdocs environment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-python-354-for-windows" title="Install python 3.5.4 for Windows" class="md-nav__link">
    Install python 3.5.4 for Windows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-mkdocs-tool-chain" title="Install mkdocs tool chain" class="md-nav__link">
    Install mkdocs tool chain
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-new-site" title="Create a new site" class="md-nav__link">
    Create a new site
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publish-the-new-mkdocs-site-locally" title="Publish the new mkdocs site locally" class="md-nav__link">
    Publish the new mkdocs site locally
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-a-ui-theme" title="Install a UI Theme" class="md-nav__link">
    Install a UI Theme
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-the-site-configuration" title="Update the site configuration" class="md-nav__link">
    Update the site configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demo-the-results-hosted-locally" title="Demo the results hosted locally" class="md-nav__link">
    Demo the results hosted locally
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publish-to-a-new-container" title="Publish to a new Container" class="md-nav__link">
    Publish to a new Container
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#poc-with-a-raw-nginx-webserver" title="PoC with a raw nginx webserver" class="md-nav__link">
    PoC with a raw nginx webserver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-dockerfile" title="Create a Dockerfile" class="md-nav__link">
    Create a Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-doc-site-and-the-new-docker-image" title="Build the doc site and the new docker image" class="md-nav__link">
    Build the doc site and the new docker image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-docker-image" title="Build the Docker image" class="md-nav__link">
    Build the Docker image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo-the-running-the-container" title="Demo the Running the container" class="md-nav__link">
    Demo the Running the container
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../kubernetes/" title="Deploy" class="md-nav__link">
      Deploy
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-docker-for-the-first-time" title="Install Docker for the first time" class="md-nav__link">
    Install Docker for the first time
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-docker-community-edition" title="Get Docker community-edition" class="md-nav__link">
    Get Docker community-edition
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-mkdocs-environment" title="Install mkdocs environment" class="md-nav__link">
    Install mkdocs environment
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-python-354-for-windows" title="Install python 3.5.4 for Windows" class="md-nav__link">
    Install python 3.5.4 for Windows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-mkdocs-tool-chain" title="Install mkdocs tool chain" class="md-nav__link">
    Install mkdocs tool chain
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-new-site" title="Create a new site" class="md-nav__link">
    Create a new site
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#publish-the-new-mkdocs-site-locally" title="Publish the new mkdocs site locally" class="md-nav__link">
    Publish the new mkdocs site locally
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-a-ui-theme" title="Install a UI Theme" class="md-nav__link">
    Install a UI Theme
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-the-site-configuration" title="Update the site configuration" class="md-nav__link">
    Update the site configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demo-the-results-hosted-locally" title="Demo the results hosted locally" class="md-nav__link">
    Demo the results hosted locally
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publish-to-a-new-container" title="Publish to a new Container" class="md-nav__link">
    Publish to a new Container
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#poc-with-a-raw-nginx-webserver" title="PoC with a raw nginx webserver" class="md-nav__link">
    PoC with a raw nginx webserver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-dockerfile" title="Create a Dockerfile" class="md-nav__link">
    Create a Dockerfile
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-doc-site-and-the-new-docker-image" title="Build the doc site and the new docker image" class="md-nav__link">
    Build the doc site and the new docker image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-the-docker-image" title="Build the Docker image" class="md-nav__link">
    Build the Docker image
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo-the-running-the-container" title="Demo the Running the container" class="md-nav__link">
    Demo the Running the container
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ukbendavies/docker-site-demo/edit/master/docs/docker.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Build</h1>
                
                <p>Several stages are usually required to build new software and publish to a production environment; in this case the software is the documentation website you are reading right now! </p>
<p>As a User I connect to an nginx webserver instance (running in a Container) that is going to serve a MkDocs website to a user agent (web browser, such as Chrome) that delivers this content payload so that we can read it.</p>
<div class="admonition question">
<p class="admonition-title">What are Containers useful for?</p>
<p>It is desirable to have a process where new software changes are promoted from a developers environment to production in a series of repeatable steps such that software is available with minimal time from initial change to production publication; Docker is one stack that can be used to perform this task with a number of supporting technology offerings at each stage throughout the deployment pipeline to help us achieve scale.</p>
<p>Local Development  </p>
<p>As a developer I would like to create software that I can run locally just like a mini-production environment so that code, deploy, debug loops are fast and my changes can be validated efficiently. I would then like the verified software changes deployed to production so that end users have the same or better experience.</p>
<p>Continuous Integration (CI) phase  </p>
<ol>
<li>Artifacts such as a website, executables and so on are created and in this case a new MkDocs website is generated for this purpose.</li>
<li>A Dockerfile is used to tell Docker how to build these artifacts into a Docker Image.</li>
<li>Docker build uses the Dockerfile to generate a new Docker Image (a set file system differences (layers)). At this point it is possible to make a new container instance locally using the new image and the docker run command</li>
<li>Finally the Docker image can be pushed to a Docker registry, for example Azure Container Registry (ACR), DockerHub, ...</li>
</ol>
<p>Continuous Delivery (CD) phase  </p>
<p>Following on from CI, the CD phase is usually handed off to other systems to manage what can be fairly complex dance: deploying, canary deployments, performing rolling upgrades and rollbacks. Some examples include Microsoft VSTS and Spinnaker (this is not an extensive list and the landscape is changing rapidly). Phrases such as immutable, idempotent, repeatable and state-less become more important as services scale.</p>
</div>
<h2 id="install-docker-for-the-first-time">Install Docker for the first time<a class="headerlink" href="#install-docker-for-the-first-time" title="Permanent link">&para;</a></h2>
<p>Docker grew up on the Linux platform, however it is now possible to use Docker on Windows (Windows 10 and Windows Server).</p>
<div class="admonition caution">
<p>In my experience mileage varies and process isolation mode (container as a process) is only available on Windows Server however this poses other problems if you use Server GUI since the kernel is quite old and more recent Windows Server Core / Nano images are much smaller and have newer kernels but Docker requires a kernel level match in order to work.</p>
<p>Microsoft has a good document that outlines the problem and provides a compatibility matrix with more recent OS.
<a href="https://docs.microsoft.com/en-us/virtualization/windowscontainers/deploy-containers/version-compatibility">Windows Container Version Compatibility</a></p>
</div>
<h3 id="get-docker-community-edition">Get Docker community-edition<a class="headerlink" href="#get-docker-community-edition" title="Permanent link">&para;</a></h3>
<p>This document focuses on Windows as this is the area of research I am interested in however (apart from occasional syntax) the commands, information and concepts are all cross-platform and will work equally well on Linux or Mac, installation process is one area of substantial difference however so it is suggested that the desired platform guidelines are followed.</p>
<p><a href="https://www.docker.com/community-edition">Get Docker community-edition</a></p>
<div class="admonition question">
<p class="admonition-title">Validate Docker installation</p>
<p>Check that the installation has succeeded by running the ubiquitous hello-world</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="n">hello-world</span>
</pre></div>
</td></tr></table>

<p>Check the Docker service configuration on Windows</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">docker</span> <span class="n">info</span>
</pre></div>
</td></tr></table>

<p>Results in a blob of output, check for details that suggest the mode of operation is Linux, if this is configured correctly a mobyLinuxVM is created to host the linux containers using the Hyper-V hypervisor.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Kernel Version: 4.9.93-linuxkit-aufs  
Operating System: Docker for Windows  
OSType: linux
</pre></div>
</td></tr></table>

</div>
<h2 id="install-mkdocs-environment">Install mkdocs environment<a class="headerlink" href="#install-mkdocs-environment" title="Permanent link">&para;</a></h2>
<h3 id="install-python-354-for-windows">Install python 3.5.4 for Windows<a class="headerlink" href="#install-python-354-for-windows" title="Permanent link">&para;</a></h3>
<p><a href="https://www.python.org/downloads/windows/">Python for Windows</a>  /
<a href="https://www.python.org/downloads/release/python-354/">Python 3.5.4 for windows x64 installer</a></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>Choose the windows 64-bit exe install option</li>
<li>Be sure to check the checkbox that adds python to path!</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">if python is already installed</p>
<p>double check the version of python at the time of creating this documentation 3.5.4 was the latest version that enabled mkdocs to work reliably.<br />
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">python</span> <span class="p">-</span><span class="n">-version</span>
</pre></div>
</td></tr></table></p>
</div>
<h3 id="install-mkdocs-tool-chain">Install mkdocs tool chain<a class="headerlink" href="#install-mkdocs-tool-chain" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>pip install mkdocs
</pre></div>
</td></tr></table>

<h2 id="create-a-new-site">Create a new site<a class="headerlink" href="#create-a-new-site" title="Permanent link">&para;</a></h2>
<p>Create a few new markdown documents for a demo site, start with a home document usually this is index.md and maybe add a simple about page called about.md luckily mkdocs can generate a stub for you.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>mkdocs new DemoDocs
</pre></div>
</td></tr></table>

<div class="admonition note">
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>INFO    -  Creating project directory: DemoDocs
INFO    -  Writing config file: DemoDocs\mkdocs.yml
INFO    -  Writing initial docs: DemoDocs\docs\index.md
</pre></div>
</td></tr></table>

</div>
<h3 id="publish-the-new-mkdocs-site-locally">Publish the new mkdocs site locally<a class="headerlink" href="#publish-the-new-mkdocs-site-locally" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>cd .\DemoDocs

mkdocs serve
</pre></div>
</td></tr></table>

<div class="admonition note">
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>INFO    -  Building documentation...
INFO    -  Cleaning site directory
[I 180702 22:41:06 server:292] Serving on http://127.0.0.1:8000
[I 180702 22:41:06 handlers:59] Start watching changes
[I 180702 22:41:06 handlers:61] Start detecting changes
[I 180702 22:41:25 handlers:132] Browser Connected: http://localhost:8000/
</pre></div>
</td></tr></table>

</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The serve command usually launches the default browser; if this has not occurred navigate to the uri address above. Check the ports and in case of collisions configure mkdocs to serve on a different port e.g. <code>-a localhost:8090</code></p>
</div>
<h2 id="install-a-ui-theme">Install a UI Theme<a class="headerlink" href="#install-a-ui-theme" title="Permanent link">&para;</a></h2>
<p><a href="https://github.com/squidfunk/mkdocs-material">View the mkdocs-material theme on GitHub</a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>pip install mkdocs-material
</pre></div>
</td></tr></table>

<h3 id="update-the-site-configuration">Update the site configuration<a class="headerlink" href="#update-the-site-configuration" title="Permanent link">&para;</a></h3>
<p>Update the site configuration for mkdocs to render the new site with a new theme. MkDocs uses the yaml format for its configuration, find the section called theme and change this to material.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">site_name</span><span class="p p-Indicator">:</span> <span class="s">&#39;DemoDocs&#39;</span>
<span class="l l-Scalar l-Scalar-Plain">pages</span><span class="p p-Indicator">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Home</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">index.md</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">About</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">about.md</span>
<span class="l l-Scalar l-Scalar-Plain">theme</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">readthedocs</span>
</pre></div>
</td></tr></table>

<h3 id="demo-the-results-hosted-locally">Demo the results hosted locally<a class="headerlink" href="#demo-the-results-hosted-locally" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>mkdocs serve
</pre></div>
</td></tr></table>

<h2 id="publish-to-a-new-container">Publish to a new Container<a class="headerlink" href="#publish-to-a-new-container" title="Permanent link">&para;</a></h2>
<h3 id="poc-with-a-raw-nginx-webserver">PoC with a raw nginx webserver<a class="headerlink" href="#poc-with-a-raw-nginx-webserver" title="Permanent link">&para;</a></h3>
<p><a href="https://docs.docker.com/samples/library/nginx">Visit the nginx project</a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker run --detach --publish 80:80 --name webserver nginx
</pre></div>
</td></tr></table>

<p>Open the nginx default website running in the running container
<a href="http://localhost:80">http://localhost:80</a></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker ps
</pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">results in container instance details</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES
9149d927a911        nginx               &quot;nginx -g &#39;daemon of&quot;   6 minutes ago       Up 6 minutes        0.0.0.0:80-&gt;80/tcp   webserver
</pre></div>
</td></tr></table>

</div>
<h3 id="create-a-dockerfile">Create a Dockerfile<a class="headerlink" href="#create-a-dockerfile" title="Permanent link">&para;</a></h3>
<div class="admonition example">
<p class="admonition-title">Requirements</p>
<ul>
<li>Use the latest nginx public image from <a href="https://hub.docker.com/">Docker Hub</a></li>
<li>Set working directory so that content can be created in the correct directory for nginx to discover the website entrypoint</li>
<li>Copy the contents from the mkdocs build artifacts: <strong>site</strong> into the image working directory</li>
</ul>
</div>
<p>The new Dockerfile that matches these requirements looks like this:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">FROM</span><span class="s"> nginx</span>
WORKINGDIR /usr/share/nginx/html
COPY site .
</pre></div>
</td></tr></table>

<h3 id="build-the-doc-site-and-the-new-docker-image">Build the doc site and the new docker image<a class="headerlink" href="#build-the-doc-site-and-the-new-docker-image" title="Permanent link">&para;</a></h3>
<p>Execute mkdocs to build the new <em>site</em> directory containing the content used for static publication. This uses the mkdocs.yml configuration that was defined earlier.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>mkdocs build
</pre></div>
</td></tr></table>

<h3 id="build-the-docker-image">Build the Docker image<a class="headerlink" href="#build-the-docker-image" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker build --tag mkdocs:v1 .
</pre></div>
</td></tr></table>

<p>As <code>docker build</code> executes, new docker image layer(s) are created that contain the changes described in the Dockerfile, almost every instruction creates a new image layer to contain each change.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Tags are used to apply and track change in new images and multiple tags can be added to a single image.</p>
<p>tag <code>:latest</code> is used by various tools including Docker and Kubernetes to identify the most recent change. This is useful in continuous delivery process where it is desirable to deploy the latest changes without having to modify configuration files or wire through version details imperatively.</p>
</div>
<div class="admonition info">
<p class="admonition-title">List the new Docker image to see the results</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>docker image ls
</pre></div>
</td></tr></table>

<p>Results in:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>REPOSITORY TAG IMAGE ID CREATED SIZE
docker-site-demo v1 fa8bbd0a2524 3 minutes ago 110MB
</pre></div>
</td></tr></table>

</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Docker build is often referred to as 'bake' or 'baking' or a 'bake phase'</p>
</div>
<h2 id="demo-the-running-the-container">Demo the Running the container<a class="headerlink" href="#demo-the-running-the-container" title="Permanent link">&para;</a></h2>
<div class="admonition fail">
<p class="admonition-title">Fail</p>
<p>todo: improve this section</p>
</div>
<p>To view the published site and show the same contents as we saw using <code>mkdocs serve</code> open a browser and navigate to the uri address of the container.</p>
<p>docker run --detach --name demo-site-instance -P 80:80 .</p>
<p>Now that the container is running, it is possible to see the process using <code>docker ps</code></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Abstract" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Abstract
              </span>
            </div>
          </a>
        
        
          <a href="../kubernetes/" title="Deploy" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deploy
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>